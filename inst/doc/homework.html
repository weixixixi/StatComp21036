<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>homework1</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">homework1</h1>



<div id="st" class="section level2">
<h2>1st</h2>
<ol style="list-style-type: decimal">
<li>Text</li>
</ol>
<p>Calculate to regression equation and test it.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.11</span>, <span class="fl">0.12</span>, <span class="fl">0.13</span>, <span class="fl">0.14</span>, <span class="fl">0.15</span>, <span class="fl">0.16</span>, <span class="fl">0.17</span>, <span class="fl">0.18</span>, <span class="fl">0.20</span>, <span class="fl">0.21</span>, <span class="fl">0.23</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">42.0</span>, <span class="fl">43.5</span>, <span class="fl">45.0</span>, <span class="fl">45.5</span>, <span class="fl">45.0</span>, <span class="fl">47.5</span>, <span class="fl">49.0</span>, <span class="fl">53.0</span>, <span class="fl">50.0</span>, <span class="fl">55.0</span>, <span class="fl">55.0</span>, <span class="fl">60.0</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>lm.sol<span class="ot">&lt;-</span><span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span><span class="sc">+</span>x)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.sol)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.0431 -0.7056  0.1694  0.6633  2.2653 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   28.493      1.580   18.04 5.88e-09 ***
## x            130.835      9.683   13.51 9.50e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.319 on 10 degrees of freedom
## Multiple R-squared:  0.9481, Adjusted R-squared:  0.9429 
## F-statistic: 182.6 on 1 and 10 DF,  p-value: 9.505e-08</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Figure</li>
</ol>
<p>Describe the relationship between two variables using scatter diagram.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Height<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">56.5</span>, <span class="fl">65.3</span>, <span class="fl">64.3</span>, <span class="fl">56.3</span>, <span class="fl">59.8</span>, <span class="fl">66.5</span>, <span class="fl">51.3</span>, <span class="fl">62.5</span>, <span class="fl">62.8</span>, <span class="fl">69.0</span>, <span class="fl">63.5</span>, <span class="fl">67.0</span>, <span class="fl">57.3</span>, <span class="fl">62.5</span>, <span class="fl">59.0</span>, <span class="fl">72.0</span>, <span class="fl">64.8</span>, <span class="fl">57.5</span>, <span class="fl">66.5</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Weight<span class="ot">&lt;-</span><span class="fu">c</span>( <span class="fl">84.0</span>, <span class="fl">98.0</span>, <span class="fl">90.0</span>, <span class="fl">77.0</span>, <span class="fl">84.5</span>, <span class="fl">112.0</span>, <span class="fl">50.5</span>, <span class="fl">112.5</span>, <span class="fl">102.5</span>, <span class="fl">112.5</span>, <span class="fl">102.5</span>, <span class="fl">133.0</span>, <span class="fl">83.0</span>, <span class="fl">84.0</span>, <span class="fl">99.5</span>, <span class="fl">150.0</span>, <span class="fl">128.0</span>, <span class="fl">85.0</span>, <span class="fl">112.0</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Weight<span class="sc">~</span>Height)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ol start="3" style="list-style-type: decimal">
<li>Table</li>
</ol>
<p>Show the estimation results of parameters.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3901401</span>, <span class="fl">0.38509514</span>, <span class="fl">0.3951850</span>, <span class="fl">0.1016328</span>, <span class="fl">0.08827257</span>, <span class="fl">0.1149931</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(a,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;Estimate&quot;</span>,<span class="st">&quot;Left&quot;</span>,<span class="st">&quot;Right&quot;</span>)))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(m, <span class="at">caption=</span><span class="st">&quot;CI&quot;</span>)</span></code></pre></div>
<table>
<caption>CI</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Left</th>
<th align="right">Right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">a</td>
<td align="right">0.3901401</td>
<td align="right">0.3951850</td>
<td align="right">0.0882726</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="right">0.3850951</td>
<td align="right">0.1016328</td>
<td align="right">0.1149931</td>
</tr>
</tbody>
</table>
</div>
<div id="nd" class="section level2">
<h2>2nd</h2>
<p>3.4:</p>
<p>1.Develop an algorithm to generate random samples from a <span class="math inline">\(Rayleigh(\sigma)\)</span> distribution. (1)Calculate cdf:<span class="math display">\[F(x)=1-{\rm exp}\left\{-\frac{x^2}{2\sigma^2}\right\}.\]</span> (2)Generate the random number <span class="math inline">\(U\sim U(0,1)\)</span>. (3)Return <span class="math inline">\(\sqrt{-2\sigma^2{\rm ln}(u)}\)</span>. 2.Generate <span class="math inline">\(Rayleigh(\sigma)\)</span> samples for several choices of <span class="math inline">\(\sigma &gt; 0\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>x1</span></code></pre></div>
<pre><code>##   [1] 1.10480235 2.34409048 0.82969608 0.71307507 1.33371333 1.08277423
##   [7] 1.21837523 1.56101676 0.84608170 2.86926213 1.31706010 1.90698364
##  [13] 1.66524813 0.76084642 0.50586449 1.32060938 0.81272393 1.01315418
##  [19] 1.58306065 1.81867396 0.69441636 0.55758419 0.73330811 2.94212764
##  [25] 1.01905636 1.90805189 1.98783366 1.46802025 2.18687051 0.85112308
##  [31] 0.62256141 1.51017298 1.33679331 0.99219730 1.46329108 2.85240683
##  [37] 2.40177742 1.03118228 0.81033275 0.27563371 0.44754024 1.77138439
##  [43] 0.52573859 1.43761000 0.76187368 1.66848397 1.63085032 0.84231407
##  [49] 1.20053093 0.35544489 2.09675481 1.46843924 1.64988066 1.83883791
##  [55] 1.43030006 1.55541339 0.98883093 1.17871894 2.45518383 1.63695830
##  [61] 1.64932356 2.07752680 2.21422828 0.31602177 0.90481698 1.18926922
##  [67] 2.10793178 1.26250286 1.07024597 0.75073032 0.01054369 1.16584974
##  [73] 1.00762878 1.84573096 0.69057190 0.89270379 1.28030637 0.58011939
##  [79] 0.51416618 1.52015885 1.37350262 1.03819219 1.21301671 1.06335720
##  [85] 1.76277508 0.98735800 1.34673833 0.83723751 0.53518604 1.88269685
##  [91] 1.54717070 0.85058404 0.43335633 0.81031261 1.02607215 1.16552026
##  [97] 0.50774048 0.75327120 1.68013449 0.96440052</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=2</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">8</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>x2</span></code></pre></div>
<pre><code>##   [1] 2.20960471 4.68818096 1.65939217 1.42615013 2.66742665 2.16554847
##   [7] 2.43675046 3.12203352 1.69216340 5.73852425 2.63412021 3.81396729
##  [13] 3.33049627 1.52169285 1.01172898 2.64121876 1.62544786 2.02630837
##  [19] 3.16612131 3.63734792 1.38883272 1.11516838 1.46661621 5.88425529
##  [25] 2.03811272 3.81610378 3.97566733 2.93604051 4.37374102 1.70224617
##  [31] 1.24512281 3.02034596 2.67358663 1.98439460 2.92658215 5.70481365
##  [37] 4.80355485 2.06236455 1.62066551 0.55126741 0.89508048 3.54276877
##  [43] 1.05147719 2.87522001 1.52374735 3.33696795 3.26170064 1.68462814
##  [49] 2.40106185 0.71088978 4.19350963 2.93687847 3.29976132 3.67767582
##  [55] 2.86060011 3.11082678 1.97766186 2.35743788 4.91036766 3.27391660
##  [61] 3.29864712 4.15505360 4.42845656 0.63204355 1.80963396 2.37853843
##  [67] 4.21586355 2.52500572 2.14049194 1.50146065 0.02108739 2.33169948
##  [73] 2.01525756 3.69146192 1.38114380 1.78540758 2.56061275 1.16023879
##  [79] 1.02833236 3.04031769 2.74700525 2.07638438 2.42603343 2.12671440
##  [85] 3.52555016 1.97471600 2.69347666 1.67447502 1.07037208 3.76539370
##  [91] 3.09434141 1.70116808 0.86671267 1.62062522 2.05214431 2.33104053
##  [97] 1.01548096 1.50654240 3.36026898 1.92880104</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=0.5</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>x3</span></code></pre></div>
<pre><code>##   [1] 0.552401177 1.172045239 0.414848042 0.356537534 0.666856663 0.541387116
##   [7] 0.609187614 0.780508381 0.423040851 1.434631063 0.658530052 0.953491822
##  [13] 0.832624067 0.380423212 0.252932244 0.660304691 0.406361964 0.506577092
##  [19] 0.791530327 0.909336980 0.347208181 0.278792096 0.366654053 1.471063822
##  [25] 0.509528180 0.954025946 0.993916831 0.734010127 1.093435256 0.425561542
##  [31] 0.311280704 0.755086490 0.668396657 0.496098650 0.731645538 1.426203413
##  [37] 1.200888711 0.515591139 0.405166377 0.137816853 0.223770119 0.885692193
##  [43] 0.262869297 0.718805002 0.380936838 0.834241987 0.815425160 0.421157034
##  [49] 0.600265463 0.177722445 1.048377407 0.734219618 0.824940331 0.919418955
##  [55] 0.715150028 0.777706694 0.494415465 0.589359469 1.227591916 0.818479151
##  [61] 0.824661779 1.038763399 1.107114139 0.158010887 0.452408491 0.594634608
##  [67] 1.053965889 0.631251431 0.535122984 0.375365162 0.005271847 0.582924870
##  [73] 0.503814389 0.922865481 0.345285949 0.446351895 0.640153187 0.290059697
##  [79] 0.257083090 0.760079423 0.686751311 0.519096096 0.606508357 0.531678601
##  [85] 0.881387540 0.493679000 0.673369166 0.418618756 0.267593020 0.941348426
##  [91] 0.773585352 0.425292020 0.216678167 0.405156305 0.513036077 0.582760132
##  [97] 0.253870240 0.376635600 0.840067246 0.482200260</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=0.1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="fl">0.02</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>x4</span></code></pre></div>
<pre><code>##   [1] 0.110480235 0.234409048 0.082969608 0.071307507 0.133371333 0.108277423
##   [7] 0.121837523 0.156101676 0.084608170 0.286926213 0.131706010 0.190698364
##  [13] 0.166524813 0.076084642 0.050586449 0.132060938 0.081272393 0.101315418
##  [19] 0.158306065 0.181867396 0.069441636 0.055758419 0.073330811 0.294212764
##  [25] 0.101905636 0.190805189 0.198783366 0.146802025 0.218687051 0.085112308
##  [31] 0.062256141 0.151017298 0.133679331 0.099219730 0.146329108 0.285240683
##  [37] 0.240177742 0.103118228 0.081033275 0.027563371 0.044754024 0.177138439
##  [43] 0.052573859 0.143761000 0.076187368 0.166848397 0.163085032 0.084231407
##  [49] 0.120053093 0.035544489 0.209675481 0.146843924 0.164988066 0.183883791
##  [55] 0.143030006 0.155541339 0.098883093 0.117871894 0.245518383 0.163695830
##  [61] 0.164932356 0.207752680 0.221422828 0.031602177 0.090481698 0.118926922
##  [67] 0.210793178 0.126250286 0.107024597 0.075073032 0.001054369 0.116584974
##  [73] 0.100762878 0.184573096 0.069057190 0.089270379 0.128030637 0.058011939
##  [79] 0.051416618 0.152015885 0.137350262 0.103819219 0.121301671 0.106335720
##  [85] 0.176277508 0.098735800 0.134673833 0.083723751 0.053518604 0.188269685
##  [91] 0.154717070 0.085058404 0.043335633 0.081031261 0.102607215 0.116552026
##  [97] 0.050774048 0.075327120 0.168013449 0.096440052</code></pre>
<p>3.Check the histogram to see if the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=1</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x1, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;light blue&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)), <span class="at">axes =</span> <span class="cn">TRUE</span>, <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">3.5</span>, .<span class="dv">01</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, y<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=2</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x2, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;light blue&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>(x<span class="sc">/</span><span class="dv">4</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">8</span>)), <span class="at">axes =</span> <span class="cn">TRUE</span>, <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, .<span class="dv">01</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, (y<span class="sc">/</span><span class="dv">4</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">8</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=0.5</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x3, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;light blue&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">4</span><span class="sc">*</span>x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)), <span class="at">axes =</span> <span class="cn">TRUE</span>, <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">1.5</span>, .<span class="dv">01</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="dv">4</span><span class="sc">*</span>y<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=0.1</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x4, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;light blue&quot;</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">100</span><span class="sc">*</span>x<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">50</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)), <span class="at">axes =</span> <span class="cn">TRUE</span>, <span class="at">cex.main =</span> <span class="fl">0.75</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">3.5</span>, .<span class="dv">01</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="dv">100</span><span class="sc">*</span>y<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">50</span><span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Conclusion:</p>
<p>When <span class="math inline">\(\sigma\)</span> takes different values, the above four diagrams can be obtained. The close distance between the graph and the histogram illustrates that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>.</p>
<p><br />
3.11:</p>
<p>1.When <span class="math inline">\(p_1=0.75\)</span>, generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0, 1)\)</span> and <span class="math inline">\(N(3, 1)\)</span> distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 = 1 − p_1\)</span>.</p>
<p>Algorithm:</p>
<p>(1)Generate the random number <span class="math inline">\(U \sim U(0,1)\)</span>.</p>
<p>(2)If <span class="math inline">\(U&lt;p_1\)</span>, take a sample <span class="math inline">\(n_1\)</span> from <span class="math inline">\(N(0,1)\)</span> otherwise take it from <span class="math inline">\(N(3,1)\)</span>.</p>
<p>(3)Repeat the above steps for 1000 times.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>f_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(p1){</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i<span class="sc">&lt;=</span><span class="dv">1000</span>) {</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(u <span class="sc">&lt;</span> p1)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    {n[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)} <span class="cf">else</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    {n[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)}</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>n}</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">f_sample</span>(<span class="fl">0.75</span>)</span></code></pre></div>
<p>2.Graph the histogram of the sample with density superimposed.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(n, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#p_1=0.9</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">f_sample</span>(<span class="fl">0.9</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(n1, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#p_1=0.5</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">f_sample</span>(<span class="fl">0.5</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(n2, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#p_1=0.1</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>n3 <span class="ot">&lt;-</span> <span class="fu">f_sample</span>(<span class="fl">0.1</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(n3, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ecdf</span>(n)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.8</span>,<span class="fl">0.8</span>,<span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.75</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.001</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">sort</span>(n1), y, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>,<span class="fl">0.95</span>,<span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.9</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">sort</span>(n2), y, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.8</span>,<span class="fl">0.5</span>,<span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.5</span>))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">sort</span>(n3), y, <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">2</span>,<span class="fl">0.1</span>,<span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA21BMVEUAAAAAACgAADoAAEgAAGYAOgAAOjoAOmYAOpAAZgAAZrYAkAAAtgAA2wAA/wAoAAA6AAA6ADo6AGY6OgA6Ojo6OmY6ZpA6ZrY6kLY6kNtIAABIgLNlmrNmAABmADpmAGZmOpBmZmZmkJBmkNtmtttmtv+ASACAs7OQAACQOgCQOmaQZgCQZjqQtpCQttuQ2/+zgEizs7O2AAC2ZgC2Zjq2kDq2pQC229u22/+2/7a2///bkDrbtmbb2//b/7bb/9vb////AAD/pQD/tmb/25D/27b//7b//9v///9LaLMrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMmklEQVR4nO2da4PjNhWG1WFph4ENXlq6LDQFyg4wQDsUF2gxl0mcJv7/vwhdLFu+SK8tS448c94PO0kcW86z5xxdfCSxiuQUu/YNpC4CBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAGlDyhnr/5VXb7JGHtbnfc3j8ahU8YPRdZGAJWM611VsNsn49DlgX8WWRsBVDBhOgMgPWAxlAagyzeM3bxVv/XfHzP24Xv1acY++koAyoUB3TyWAtMpkz73IP7lr+8j31oSgM57AYB9JAKKZCHcSTBQagAVAgo3G+lsAg0/MbaPJQGIG8m3whr4j+XB5hdP3+/ruHP3JGxLuxgndldJcDdfZsq58ug+lgKg2g6kfeTKSD79Zx18xEENiL8UgARKxlR1pr4TUykAkj9YORG3Dm0Stb0YQVrZWKXcUL0qWKfej6AUAJXMBHRXf6rtZQRQmWkuLwOQURd1LagOM31AMnqrr70MQNpWhFRQKX/+1UgM0oB4DfYx0y9fAiCO4uZ9xasubhXc3d4+CRO5r2uxnPWDNOd0+9+9IvMygrRuB9U/Wequfdmr5kUt/yjpVS+lmq+q7//CK7JPv5WvZUv6d+LV5e8Zb1MbXY2itjHhXbkwshU6Y2kAmqiyH3FOWewQtC1A3GC6Xa/ypXRWp6poqzupnIY7ujrvO5UWDZglIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICAAgNim9G1AIW9XDwRIKCtAjr9bDSfpWRGblnBAqS2rgyo8eyvhfgHnn/Pv/zBH0Y+L28++/qvH3ym3v/+g8fq9NNfTbvuQeioxdhuxz+X97kuoECXK9loVu/lQWZtquSy817O63Cl3h0aHXc9zb/R6wM6vfkyU4mrJXtXjgE6ZSIzsVCHSule5aiTaS7cRLi9dIB432gCgDKZNK6yM8cBvXlsD9WABhPpJJlK1t/SnSoHnTk3mgIgw2dGAXWMpjanFlBtNbJ0hYe/clrPrBtNAZD4rfXP14B0kr2MO12vytWsDQmoQVOpiqJq+AS70QQAvTF+PnYxCe/Vd58/mnBEyapowQfjeW6AzCAtdThkf+uWq/gcp/LZFCAZg/JuDOq4WKeaV37VreZNPNP4bAuQnLzjqMWkeekQdNizXi3f9DwFnol8tgXoi4zpSmkckO5dXB7Y4SDmTnX5qL/HOXxiAeKWfycnRNqm83vXYlPUjcq6RC8+kQAJz89FXFDt/aWXU5oKaIyO4V7z+MQBJIOlcn9bXygeICeeOv5Uk/nEAXTe3+soYYkV0caDAJ7ZfLZkQaPqjQtpPMa4kJ5sfy9mvB6PwvGnO1j0GKRaJksvZ1dvXpi2H7O6l9H5vL8TLc25AWjOjV6/FhtRd1yoic6dBqP0L9m6Lj34bKkdpGUdF2rCT9vlqDumqhF+nB2A5txoQoAs40JteG46rTo65+Jbx+MnHNe7eQYUHVARvhazjAsZ9Zce9tB8ZGvseNyLU/J5fK42aL8I0Ni4kBw/7Y4LNYWI97V/VbuZ03u36GJjwx6d9o/6BmMaRX77pPlUu8kdlpk3mjagbvtQ2lhbwQkPa/js3sx7VBYJkF53zWrPi2NQZ1zocOiPC/GXzbgQ5yUMSGLb2Zr2NkVqKOqFDkrbigeLAA3Ghfr9CxF+2qGg8kY5GCe2q/KZSzDE62ooRehqDMeF+h0waUtqXEhYUfGqdrB8t5u9nGK8zqpShM7qsFc/4NM73kbo+aVt0oJ6gBAfI0LPLy1WDNIeECUGOQGN8FlgQLFqsXotLfuqPQFbDd0I5OKTEKA1L2fyGWuiaz5eBvQMAHX5DI8vM6BnBWi0h3dcZkDbB2Q+dR85bPBZDVA7yLtAEQCNjhA0fDwNaDagdrVQtdS3r0IBaviMj6Ac1wZ0/rXJpPsuTrluGUk/Y4dNPitZUCiFAqQvh/j4GpAHoMt/PIvyK9etBtDYwQ6f9QDJR0xclz8tWZowDCCXAZl4/A3IrxZT68kuWrsxCCAdgSbwWRNQPVzotfZniEH7VnY+xy4ffwPyC9JqnetFCgGoNqBRPr0P1gWUM/b+YeHyukEAWS7VN58lHuYVpOvHvlePQRYDGuBZYkA+gH6jTOf6tVidNN9LgWn4tCkwu50an7qr5mvDDUUZgjifbgpMy6dNgdnVz9J8tOGuRs2nmwLT8DFSYHgEmvs0rNVGO6s6BYb1UmDa+GNk3fMIVPh417wbTWu445SxvXh4KC/TAjLicztvQ1Rh+SfeLbfgX1zlcqcsO8i0cfFGA+pU7+3Mn52we5n54kMoKiBH4u5iQPtK2LKZwHA8mg/oG0BtG8grEHkAgokJzUMfx7cWx6A/iouYgHrNn8bF2jbQ9FR9Qx6AcvwfUT8vjGhBCpCZAtNrHjZB2gDkU9f7tKQnuLJy+pgulgkDalNgpP2YLqareelhdVLaOi5mZCa4pCZExgN089hUpPyHj3Qv6oaiMiDZHlopSKuUEqyCvYsH6JB9wYwUmH8M+dRTo3Y7db+5b7vEqx00raRT9mFEQPfGFUbsR2tBN1XJqzeParFagy2IfMod1eGQGfN3HHyuASiMFgLiLenmjQPPcj5bTCSvRD/VNCDHF1cHNLEKs18lyJi0WFpCv3bzuQ4g6xynGOWO6WCc7+ITwIA2CehgeJibT7qAYiaSmxHI6WAhDCgSoKiJ5EYEAnySBRQ3Dbg1IDefIAYUB1DcRPLGgBCf6wCCIz1VZAsSE8PkC8AnjAFFaijGTCRvDcj9vTAGFKslHS+RfGUD2l5fTBsQ5PNCAbUG5P5eKD7bAzTVgDyvP9BGAa3lYJsDpBuJgE84A9oYoMPqBrQ1QNMMKCCfrQFanc+2AE11MJ9r27QlQIcrGNC2AE0yoLB81ga0ZNC+jtCrOtiWLOgqDrYpQNU1+GwHUG1AKzvYdgABPjqXvGdAZXe5W8tmHE5tBlDl4qNzyft8zOUUB4suTtNGAGkDGj9a55L31+/vrb9t2YwDaCuAhg42WE5xEJ+7K7jbNuMIdaPXBCS2CBF/OwbUX05xWH/19gDwS1LcBiC9FL35YXc5RTZSfQ32ZkkIUNBn89p+eonQxnKKu5/oJQFHc8n1KekACvpsXvEZJNq1qwXaZvOk62JBn6yqCmxYwWtAr0XwmbbNRjKAQj6bl3zG8jRlDNr96Ie7TjFjueTNKckACmhBNZ+RI7wWe81jz9RtNuzfcivtZ/MHO5/qNfvx9G027lzfcirlZ/PNDmn9A3IPOa+5O/OVcDtoLPoYG+y9ZED1/npqA7la/b0HnwuguYnkeu9BA84Azaq61pi02L3zaFFvw8ol240G+LsuoFiXi6ckY1BK2kJn9araQGf1urpaV2MzigFoQmcVXS/hwwHOmmBBKROID2hCZzVlAisAwp3VlAmsAWjx9RI+HPQs7+slfDjoWd7XS/hw0LO8r5fw4aBneV8v4cNBz3pBIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERIKAIgHL7gKx88Ggbzu7NwJhzKixYJK55bQ4QAVBpH7G+PHACheVG+4l1M06FBVclP6R3L5qn4IDOe/t9DvJTDQ1SM6efigtWF3edbVVwQMXtn8HmLuNmgglYT8UF+28vERwQvxVXKBAaX9l7kB4+/VRccPnqu33s3QGmSdgyAGR56DiYYDD9VFyw3BRs6oLQXQUGJB5JuwGVjhgNANlOxQUXNxPMc1xhAUk/cQKyGgF2MYf9oIJVaIu7OwBSIZopRZ1bMryRQrViCuuPhEHafmp9+fGCpRT3uLsDTJfDggr7Ut2gmnedigtWiTsJuJiU/T7VZDmL3A1F56mwYBmi/BbzXRVQ7QgWCoWrq+E+FRWsdi5KoZp/fiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgSUOiCRcnbeL9+l21upAxJZT9bFitZQ6oBEivPn3lngAZQ8oCr3m4QSSukDKnH2ZkwlD+jy8Fuf5NRgSh5Qcfs/r+zUUEodkMhw9spvDqXUAeUywfmKYTp1QFcXAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICA/g8uVl7DzY4ZjwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">f_sample</span>(<span class="fl">0.3</span>), <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">f_sample</span>(<span class="fl">0.7</span>), <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">f_sample</span>(<span class="fl">0.45</span>), <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">f_sample</span>(<span class="fl">0.55</span>), <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>4.Make a conjecture about the values of p1 that produce bimodal mixtures.</p>
<p>From the above diagrams, we can see the empirical distribution of the mixture appears to be bimodal when the value of <span class="math inline">\(p_1\)</span> is around 0.5.</p>
<p><br />
3.20:</p>
<p>1.Write a program to simulate a compound <span class="math inline">\(P(λ)–Ga\)</span> process (<span class="math inline">\(Y\)</span> has a Gamma distribution).</p>
<p><span class="math display">\[Y\sim Ga(\alpha,\beta)\]</span></p>
<p>Algorithm:</p>
<p>(1)<span class="math inline">\(X=0\)</span>, <span class="math inline">\(I=1\)</span>.</p>
<p>(2)Generate a random number <span class="math inline">\(N\sim P(\lambda t)\)</span></p>
<p>(3)Generate a random number <span class="math inline">\(Y\sim Ga(\alpha,\beta)\)</span>.</p>
<p>(4)<span class="math inline">\(X=X+Y\)</span>, <span class="math inline">\(I=I+1\)</span>.</p>
<p>(5)If <span class="math inline">\(I\geq N\)</span>, Stop. Otherwise, repeat Step(3).</p>
<p>(6)Return <span class="math inline">\(X\)</span>.</p>
<p>Then simulate the compound Poisson process and let <span class="math inline">\(t=10\)</span>, the parameter <span class="math inline">\(\lambda=6\)</span>, <span class="math inline">\(\alpha=1\)</span>, <span class="math inline">\(\beta=2\)</span>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>f_poisson <span class="ot">&lt;-</span> <span class="cf">function</span>(t, lambda, alpha, beta){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda<span class="sc">*</span>t)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (I <span class="sc">&lt;=</span> N) {</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1</span>, alpha, beta)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> X <span class="sc">+</span> u</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  I <span class="ot">=</span> I <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>X}</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">f_poisson</span>(<span class="dv">10</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 26.3023</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the parameters and compare with the theoretical values.</li>
</ol>
<p>When <span class="math inline">\(t=10\)</span>, theoretical mean and variance can be calculated:</p>
<p><span class="math display">\[E(X(t))=\lambda tE(Y_1)=\lambda\times 10\times \frac{\alpha}{\beta}=\frac{10\alpha\lambda}{\beta}\]</span> <span class="math display">\[Var(X(t))=\lambda tE(Y_1^2)=\lambda\times 10\times \frac{\alpha+\alpha^2}{\beta^2}=\frac{10(\alpha+\alpha^2)\lambda}{\beta^2}\]</span> Repeat the above algorithm for <span class="math inline">\(N\)</span> times to take mean and variance of <span class="math inline">\(X(10)\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>When <span class="math inline">\(\lambda=1\)</span>, <span class="math inline">\(\alpha=1\)</span>, <span class="math inline">\(\beta=1\)</span>, the theoretical values of mean and variance are 10, 20, respectively.</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>f_meanvar <span class="ot">&lt;-</span> <span class="cf">function</span>(N, lambda, alpha, beta){</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    m[i] <span class="ot">&lt;-</span> <span class="fu">f_poisson</span>(<span class="dv">10</span>, lambda, alpha, beta)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  a1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(m)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">var</span>(m)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  a2 <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">*</span>alpha<span class="sc">*</span>lambda<span class="sc">/</span>beta</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  b2 <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">*</span>(alpha<span class="sc">+</span>alpha<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>lambda<span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  e1 <span class="ot">&lt;-</span> <span class="fu">abs</span>(a1<span class="sc">-</span>a2)<span class="sc">/</span>a2</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  e2 <span class="ot">&lt;-</span> <span class="fu">abs</span>(b1<span class="sc">-</span>b2)<span class="sc">/</span>b2</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  e2</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">c</span>(a1, a2, e1, b1, b2, e2)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  d</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">f_meanvar</span>(<span class="dv">1000</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dv">4</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>r1</span></code></pre></div>
<pre><code>## [1]  9.7513 10.0000  0.0249 19.3105 20.0000  0.0345</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>When <span class="math inline">\(\lambda=1\)</span>, <span class="math inline">\(\alpha=1\)</span>, <span class="math inline">\(\beta=2\)</span>, the theoretical values of mean and variance are 5, 5, respectively.</li>
</ol>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">f_meanvar</span>(<span class="dv">1000</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">4</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>r2</span></code></pre></div>
<pre><code>## [1] 5.1665 5.0000 0.0333 5.4873 5.0000 0.0975</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>When <span class="math inline">\(\lambda=1\)</span>, <span class="math inline">\(\alpha=2\)</span>, <span class="math inline">\(\beta=1\)</span>, the theoretical values of mean and variance are 20, 60, respectively.</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>r3 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">f_meanvar</span>(<span class="dv">1000</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="dv">4</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>r3</span></code></pre></div>
<pre><code>## [1] 20.0070 20.0000  0.0004 57.3547 60.0000  0.0441</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>When <span class="math inline">\(\lambda=1\)</span>, <span class="math inline">\(\alpha=2\)</span>, <span class="math inline">\(\beta=2\)</span>, the theoretical values of mean and variance are 10, 15, respectively.</li>
</ol>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>r4 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">f_meanvar</span>(<span class="dv">1000</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="dv">4</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>r4</span></code></pre></div>
<pre><code>## [1] 10.0048 10.0000  0.0005 15.3496 15.0000  0.0233</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li>When <span class="math inline">\(\lambda=2\)</span>, <span class="math inline">\(\alpha=1\)</span>, <span class="math inline">\(\beta=1\)</span>, the theoretical values of mean and variance are 20, 40, respectively.</li>
</ol>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>r5 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">f_meanvar</span>(<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dv">4</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>r5</span></code></pre></div>
<pre><code>## [1] 20.1609 20.0000  0.0080 41.5669 40.0000  0.0392</code></pre>
<ol start="6" style="list-style-type: lower-alpha">
<li>When <span class="math inline">\(\lambda=3\)</span>, <span class="math inline">\(\alpha=1\)</span>, <span class="math inline">\(\beta=1\)</span>, the theoretical values of mean and variance are 10, 10, respectively.</li>
</ol>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>r6 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">f_meanvar</span>(<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">4</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>r6</span></code></pre></div>
<pre><code>## [1] 10.0346 10.0000  0.0035  9.9248 10.0000  0.0075</code></pre>
<ol start="7" style="list-style-type: lower-alpha">
<li>When <span class="math inline">\(\lambda=2\)</span>, <span class="math inline">\(\alpha=2\)</span>, <span class="math inline">\(\beta=1\)</span>, the theoretical values of mean and variance are 40, 120, respectively.</li>
</ol>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>r7 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">f_meanvar</span>(<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="dv">4</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>r7</span></code></pre></div>
<pre><code>## [1]  39.5825  40.0000   0.0104 129.0581 120.0000   0.0755</code></pre>
<ol start="8" style="list-style-type: lower-alpha">
<li>When <span class="math inline">\(\lambda=2\)</span>, <span class="math inline">\(\alpha=2\)</span>, <span class="math inline">\(\beta=2\)</span>, the theoretical values of mean and variance are 20, 30, respectively.</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>r8 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">f_meanvar</span>(<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="dv">4</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>r8</span></code></pre></div>
<pre><code>## [1] 19.7355 20.0000  0.0132 27.9479 30.0000  0.0684</code></pre>
<p>Estimations of the mean and the variance and their comparison between estimations and theoretical values(errors) of <span class="math inline">\(X(10)\)</span> for several choices of the parameters<span class="math inline">\((\lambda, \alpha, \beta)\)</span> are listed below:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(r1, r2, r3, r4, r5, r6, r7, r8)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(a, <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">ncol =</span> <span class="dv">6</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;(1,1,1)&quot;</span>, <span class="st">&quot;(1,1,2)&quot;</span>, <span class="st">&quot;(1,2,1)&quot;</span>, <span class="st">&quot;(1,2,2)&quot;</span>, <span class="st">&quot;(2,1,1)&quot;</span>, <span class="st">&quot;(2,1,2)&quot;</span>, <span class="st">&quot;(2,2,1)&quot;</span>, <span class="st">&quot;(2,2,2)&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;Simutation m&quot;</span>, <span class="st">&quot;Theory m&quot;</span>, <span class="st">&quot;Error m&quot;</span>, <span class="st">&quot;Simutation v&quot;</span>, <span class="st">&quot;Theory v&quot;</span>, <span class="st">&quot;Error v&quot;</span>)))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(m)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Simutation m</th>
<th align="right">Theory m</th>
<th align="right">Error m</th>
<th align="right">Simutation v</th>
<th align="right">Theory v</th>
<th align="right">Error v</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(1,1,1)</td>
<td align="right">9.7513</td>
<td align="right">10</td>
<td align="right">0.0249</td>
<td align="right">19.3105</td>
<td align="right">20</td>
<td align="right">0.0345</td>
</tr>
<tr class="even">
<td align="left">(1,1,2)</td>
<td align="right">5.1665</td>
<td align="right">5</td>
<td align="right">0.0333</td>
<td align="right">5.4873</td>
<td align="right">5</td>
<td align="right">0.0975</td>
</tr>
<tr class="odd">
<td align="left">(1,2,1)</td>
<td align="right">20.0070</td>
<td align="right">20</td>
<td align="right">0.0004</td>
<td align="right">57.3547</td>
<td align="right">60</td>
<td align="right">0.0441</td>
</tr>
<tr class="even">
<td align="left">(1,2,2)</td>
<td align="right">10.0048</td>
<td align="right">10</td>
<td align="right">0.0005</td>
<td align="right">15.3496</td>
<td align="right">15</td>
<td align="right">0.0233</td>
</tr>
<tr class="odd">
<td align="left">(2,1,1)</td>
<td align="right">20.1609</td>
<td align="right">20</td>
<td align="right">0.0080</td>
<td align="right">41.5669</td>
<td align="right">40</td>
<td align="right">0.0392</td>
</tr>
<tr class="even">
<td align="left">(2,1,2)</td>
<td align="right">10.0346</td>
<td align="right">10</td>
<td align="right">0.0035</td>
<td align="right">9.9248</td>
<td align="right">10</td>
<td align="right">0.0075</td>
</tr>
<tr class="odd">
<td align="left">(2,2,1)</td>
<td align="right">39.5825</td>
<td align="right">40</td>
<td align="right">0.0104</td>
<td align="right">129.0581</td>
<td align="right">120</td>
<td align="right">0.0755</td>
</tr>
<tr class="even">
<td align="left">(2,2,2)</td>
<td align="right">19.7355</td>
<td align="right">20</td>
<td align="right">0.0132</td>
<td align="right">27.9479</td>
<td align="right">30</td>
<td align="right">0.0684</td>
</tr>
</tbody>
</table>
<p>The errors of means and variances are all less than 0.1, so we can make a conclusion from this form that the estimations of mean and variance values are close to the theoretical values.</p>
</div>
<div id="rd" class="section level2">
<h2>3rd</h2>
<p>5.4: Beta(3, 3) pdf is:<span class="math display">\[h(x)=30x^2(1-x)^2,\]</span> <span class="math display">\[g(y)=30xy^2(1-y)^2,Y\sim N(0,x).\]</span> Beta(3, 3) cdf is:<span class="math display">\[F(x)=\int_0^xh(t)dt=E[(g(y))]=E_Y[30xy^2(1-y)^2],Y\sim N(0,x).\]</span> Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1, 0.2,..., 0.9\)</span>. Compare the estimates with the values returned by the <span class="math inline">\(pbeta\)</span> function in R.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>f_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> x)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  F_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(y<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">30</span><span class="sc">*</span>x</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  F_hat</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>){</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">f_1</span>(i<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(i<span class="sc">/</span><span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  err <span class="ot">&lt;-</span> <span class="fu">abs</span>((a<span class="sc">-</span>b)<span class="sc">/</span>b)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">c</span>(a, b, err)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(d,<span class="dv">4</span>))</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 0.0086 0.0086 0.0053
## [1] 0.0585 0.0579 0.0103
## [1] 0.1639 0.1631 0.0053
## [1] 0.3215 0.3174 0.0129
## [1] 0.4958 0.5000 0.0084
## [1] 0.6785 0.6826 0.0060
## [1] 0.8338 0.8369 0.0037
## [1] 0.9460 0.9421 0.0042
## [1] 1.0027 0.9914 0.0114</code></pre>
<p>Conclusion: We could get the result of small difference(&lt;0.05) between MC method and <span class="math inline">\(pbeta\)</span> function in R.</p>
<p><br />
5.9: Implement a function to generate samples from a Rayleigh(σ) distribution, using antithetic variables. (1)Calculate cdf:<span class="math display">\[F(x)=1-{\rm exp}\left\{-\frac{x^2}{2\sigma^2}\right\}.\]</span><br />
(2)Generate the random number <span class="math inline">\(U\sim U(0,1)\)</span>.<br />
(3)Return <span class="math inline">\(\sqrt{-2\sigma^2{\rm ln}(u)}\)</span>.<br />
Generate <span class="math inline">\(Rayleigh(\sigma)\)</span> samples for several choices of <span class="math inline">\(\sigma &gt; 0\)</span>.<br />
</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=1</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=1</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=2</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">8</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=0.5</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=0.1</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="fl">0.02</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=1</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=2</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">8</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=0.5</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=0.1</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="fl">0.02</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=1</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>z1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=2</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>z2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">8</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=0.5</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>z3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="co">#σ=0.1</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>z4 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="fl">0.02</span><span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>scales<span class="sc">::</span><span class="fu">percent</span>((<span class="fu">var</span>((x1<span class="sc">+</span>z1)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">var</span>((x1<span class="sc">+</span>y1)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">var</span>((x1<span class="sc">+</span>z1)<span class="sc">/</span><span class="dv">2</span>),<span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] &quot;94.33%&quot;</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>scales<span class="sc">::</span><span class="fu">percent</span>((<span class="fu">var</span>((x2<span class="sc">+</span>z2)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">var</span>((x2<span class="sc">+</span>y2)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">var</span>((x2<span class="sc">+</span>z2)<span class="sc">/</span><span class="dv">2</span>),<span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] &quot;94.33%&quot;</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>scales<span class="sc">::</span><span class="fu">percent</span>((<span class="fu">var</span>((x3<span class="sc">+</span>z3)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">var</span>((x3<span class="sc">+</span>y3)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">var</span>((x3<span class="sc">+</span>z3)<span class="sc">/</span><span class="dv">2</span>),<span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] &quot;94.33%&quot;</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>scales<span class="sc">::</span><span class="fu">percent</span>((<span class="fu">var</span>((x4<span class="sc">+</span>z4)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">var</span>((x4<span class="sc">+</span>y4)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">var</span>((x4<span class="sc">+</span>z4)<span class="sc">/</span><span class="dv">2</span>),<span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] &quot;94.33%&quot;</code></pre>
<p>Conclusion: We could see using antithetic variables can represent a more than 90% reduction in variance, compared with simple method.</p>
<p><br />
5.13: Find two importance functions f1 and f2 that are supported on (1, ∞) and are ‘close’ to g(x). Here we choose:<span class="math display">\[f_1=\frac{1}{x^2},\]</span> <span class="math display">\[f_2=\frac{1}{\pi}\frac{1}{1 + (x-\sqrt{2})^2}.\]</span> So densities and the ratio <span class="math inline">\(g(x)/f(x)\)</span> can be plotted.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>, .<span class="dv">01</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> ((<span class="dv">1</span> <span class="sc">+</span> (x<span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">2</span>))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> pi)<span class="co">#Cauchy distribution f(x,sqrt(2),1)</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> (x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">#figure (a)</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">lwd =</span> w)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, f1, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> w)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, f2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#figure (b)</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">3</span>), <span class="at">lwd =</span> w, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f1, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> w)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f2, <span class="at">lty =</span> <span class="dv">4</span>, <span class="at">lwd =</span> w)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>), <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lwd =</span> w, <span class="at">inset =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(g<span class="sc">/</span>f1)</span></code></pre></div>
<pre><code>## [1] 0.2791358</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(g<span class="sc">/</span>f2)</span></code></pre></div>
<pre><code>## [1] 0.3214099</code></pre>
<p>Conclusion: Standard deviation of g/f1 is smaller than g/f2, which means the ratio is closer to a constant. So f1 can be considered as a better important function.</p>
<p><br />
5.14: Obtain a Monte Carlo estimate of <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span>by importance sampling. cdf:<span class="math display">\[F(x)=1-\frac{1}{x}\]</span></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((x<span class="sc">^</span><span class="dv">4</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.3985296</code></pre>
<p>We choose f1 from 5.13 as the important function to estimate this integration, and the estimation is around 0.4.</p>
</div>
<div id="th" class="section level2">
<h2>4th</h2>
<p>6.5: To obtain a Monte Carlo estimate of <span class="math inline">\(\theta = E[X]\)</span> based on 20 replicates, generate random samples <span class="math inline">\(X_i\)</span> from <span class="math inline">\(\chi^2(2)\)</span> distribution, <span class="math inline">\(i=1,2,...,20.\)</span></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>){</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  m</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> m<span class="sc">+</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span><span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="sc">*</span>s<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    a[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (p[<span class="dv">1</span>]<span class="sc">&lt;</span>a[i]<span class="sc">&amp;</span>a[i]<span class="sc">&lt;</span>p[<span class="dv">2</span>]){</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>      b <span class="ot">&lt;-</span> b<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  q[k] <span class="ot">&lt;-</span> b<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(q)</span></code></pre></div>
<pre><code>## [1] 0.885765</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>(n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(<span class="fl">0.05</span>, <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(UCL<span class="sc">&gt;</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.783</code></pre>
<p>Conclusion: The probability that the confidence interval covers the mean is larger than the probability that the confidence interval covers the variance. So we could get the result that the t-interval is more robust to departures from normality than the interval for variance.</p>
<p><br />
6.A:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#storage for p-values</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x1,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>p1[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>p.hat1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(p1 <span class="sc">&lt;</span> alpha)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>se.hat1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat1) <span class="sc">/</span> m)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat1, se.hat1))</span></code></pre></div>
<pre><code>## [1] 0.102300000 0.003030424</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#storage for p-values</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x2,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>p2[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>p.hat2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(p2 <span class="sc">&lt;</span> alpha)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>se.hat2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat2) <span class="sc">/</span> m)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat2, se.hat2))</span></code></pre></div>
<pre><code>## [1] 0.050300000 0.002185633</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#storage for p-values</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x3,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>p3[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>p.hat3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(p3 <span class="sc">&lt;</span> alpha)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>se.hat3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat3 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat3) <span class="sc">/</span> m)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat3, se.hat3))</span></code></pre></div>
<pre><code>## [1] 0.078800000 0.002694264</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>Type_I_error<span class="ot">&lt;-</span><span class="fu">c</span>(p.hat1,p.hat2,p.hat3)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>sd_Type_I_error<span class="ot">&lt;-</span><span class="fu">c</span>(se.hat1,se.hat2,se.hat3)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>Three_Distribution<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Chisq&quot;</span>,<span class="st">&quot;Uniform&quot;</span>,<span class="st">&quot;Exp&quot;</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>MC_result<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Three_Distribution,Type_I_error,sd_Type_I_error)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>MC_result</span></code></pre></div>
<pre><code>##   Three_Distribution Type_I_error sd_Type_I_error
## 1              Chisq       0.1023     0.003030424
## 2            Uniform       0.0503     0.002185633
## 3                Exp       0.0788     0.002694264</code></pre>
<p><br />
class:</p>
<p>(1)<span class="math inline">\(H_0:\beta_1-\beta_2=0\)</span>; <span class="math inline">\(H_1:\beta_1-\beta_2\neq 0\)</span>. Take <span class="math inline">\(\alpha=0.05.\)</span></p>
<p>(2)Paired-t test is better. Note the result of test 1<span class="math inline">\(X_i\)</span>, the result of test 1<span class="math inline">\(Y_i\)</span>, correct rejection is 1 and wrong rejection is 0. <span class="math inline">\(X_i,Y_i\in\{0,1\},i=1,\cdots,n\)</span>, <span class="math inline">\(\frac{1}{n}\sum_{i=1}^n(Y_i-X_i)\sim N(\beta_1-\beta_2,\frac{\sigma^2}{n})\)</span>,<span class="math inline">\(\hat{\sigma_n}^2=\sum_{i=1}^n(Y_i-X_i-\bar{Y}-\bar{X})^2/n-1\)</span>. So<span class="math inline">\(\frac{1/n\sum_{i=1}^n(Y_i-X_i)}{\sqrt{\hat{\sigma_n}^2/n}}\sim t(n-1)\)</span> .It can calculate the difference between paired samples.</p>
<p>(3)<span class="math inline">\(t_{n-1,\alpha/2}\leq T&lt; t_{n-1,1-\alpha/2}\)</span>, so we only need to know the quantile of t distribution and the distance between two probabilities.</p>
</div>
<div id="th-1" class="section level2">
<h2>5th</h2>
<p>6.C: Here we take <span class="math inline">\(d=3\)</span>, <span class="math inline">\(\alpha=0.05\)</span> and <span class="math inline">\(n=10,20,30,50,100,500\)</span> for Type I error in Mardia’s multivariate skewness test; Then take <span class="math inline">\(d=3\)</span>, <span class="math inline">\(\alpha=0.1\)</span> and <span class="math inline">\(n=30\)</span> for Type II error(power).</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Type I error</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co">#sample sizes</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> (<span class="dv">6</span><span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qchisq</span>(.<span class="dv">95</span>, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>) </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x,n) {</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">apply</span>(x,<span class="dv">2</span>,mean)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nr=</span>n,<span class="at">nc=</span>n) </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> (x[i,]<span class="sc">-</span>xbar)<span class="sc">%*%</span><span class="fu">solve</span>(<span class="fu">cov</span>(x)<span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">*</span>n)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    x2[i,j] <span class="ot">&lt;-</span> x1<span class="sc">%*%</span>(x[j,]<span class="sc">-</span>xbar)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">mean</span>(x2<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n[i]<span class="sc">*</span>d),<span class="at">nr=</span>n[i],<span class="at">nc=</span>d)</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a><span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>    sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sk</span>(x,n[i]) <span class="sc">&gt;=</span> cv[i] )</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>  p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.000 0.000 0.015 0.055 0.035 0.035</code></pre>
<p>Conclusion1: When the sum of samples increases, the estimates of p-value can be closer to <span class="math inline">\(\alpha=0.05\)</span>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Type II error</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">01</span>), <span class="fu">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, .<span class="dv">05</span>))</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> (<span class="dv">6</span><span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha, d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>) </span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e))</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>d, <span class="dv">0</span>, sigma),<span class="at">nr=</span>n,<span class="at">nc=</span>d)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sk</span>(x,n) <span class="sc">&gt;=</span> cv)</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, pwr, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pwr <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pwr) <span class="sc">/</span> m) <span class="co">#add standard errors</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>pwr</span></code></pre></div>
<pre><code>##  [1] 0.040 0.240 0.475 0.620 0.640 0.795 0.820 0.875 0.870 0.950 0.955 0.945
## [13] 0.950 0.955 0.940 0.965 0.975 0.965 0.935 0.920 0.880 0.790 0.670 0.625
## [25] 0.495 0.440 0.390 0.275 0.185 0.125 0.095 0.025 0.075 0.040</code></pre>
<p>Conclusion2: When <span class="math inline">\(\epsilon falls around (0.1,0.3)\)</span>, the power function can be very high.</p>
</div>
<div id="th-2" class="section level2">
<h2>6th</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>mec <span class="ot">&lt;-</span> scor<span class="sc">$</span>mec</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> scor<span class="sc">$</span>vec</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>alg <span class="ot">&lt;-</span> scor<span class="sc">$</span>alg</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>ana <span class="ot">&lt;-</span> scor<span class="sc">$</span>ana</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>sta <span class="ot">&lt;-</span> scor<span class="sc">$</span>sta</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mec,vec,alg,ana,sta)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor))</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">max</span>(a<span class="sc">$</span>val)<span class="sc">/</span><span class="fu">sum</span>(a<span class="sc">$</span>val)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>theta.hat</span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#jackknife</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  scor_new <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mec[<span class="sc">-</span>i],vec[<span class="sc">-</span>i],alg[<span class="sc">-</span>i],ana[<span class="sc">-</span>i],sta[<span class="sc">-</span>i])</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  a_new <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor_new))</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(a_new<span class="sc">$</span>val)<span class="sc">/</span><span class="fu">sum</span>(a_new<span class="sc">$</span>val)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span><span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>bias</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>se</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bootstrap</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  mec <span class="ot">&lt;-</span> scor<span class="sc">$</span>mec[i]</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  vec <span class="ot">&lt;-</span> scor<span class="sc">$</span>vec[i]</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  alg <span class="ot">&lt;-</span> scor<span class="sc">$</span>alg[i]</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  ana <span class="ot">&lt;-</span> scor<span class="sc">$</span>ana[i]</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  sta <span class="ot">&lt;-</span> scor<span class="sc">$</span>sta[i]</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  scor_new0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mec,vec,alg,ana,sta)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  a_new0 <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor_new0))</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  R[b] <span class="ot">&lt;-</span> <span class="fu">max</span>(a_new0<span class="sc">$</span>val)<span class="sc">/</span><span class="fu">sum</span>(a_new0<span class="sc">$</span>val)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>bias.R <span class="ot">&lt;-</span> <span class="fu">mean</span>(R<span class="sc">-</span>theta.hat)</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>bias.R</span></code></pre></div>
<pre><code>## [1] -0.003062348</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>se.R <span class="ot">&lt;-</span> <span class="fu">sd</span>(R)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>se.R</span></code></pre></div>
<pre><code>## [1] 0.04776327</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>eigenmax <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  scor_new1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>],x[i,<span class="dv">3</span>],x[i,<span class="dv">4</span>],x[i,<span class="dv">5</span>])</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  a_new1 <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor_new1))</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(a_new1<span class="sc">$</span>val)<span class="sc">/</span><span class="fu">sum</span>(a_new1<span class="sc">$</span>val)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> scor, <span class="at">statistic =</span> eigenmax, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>obj</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = scor, statistic = eigenmax, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original      bias    std. error
## t1* 0.619115 0.001542853  0.04746452</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#95%percentile</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(obj, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;))
## 
## Intervals : 
## Level      Normal              Basic              Percentile     
## 95%   ( 0.5245,  0.7106 )   ( 0.5266,  0.7145 )   ( 0.5237,  0.7116 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BCa</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>boot.BCa <span class="ot">&lt;-</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x, th0, th, stat, <span class="at">conf =</span> .<span class="dv">95</span>) {</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap with BCa bootstrap confidence interval</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co"># th0 is the observed statistic</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="co"># th is the vector of bootstrap replicates</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co"># stat is the function to compute the statistic</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x) <span class="co">#observations in rows</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>conf, conf))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  zalpha <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(alpha)</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the bias correction factor</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  z0 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">sum</span>(th <span class="sc">&lt;</span> th0) <span class="sc">/</span> <span class="fu">length</span>(th))</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the acceleration factor (jackknife est.)</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  th.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>    J <span class="ot">&lt;-</span> N[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)]</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    th.jack[i] <span class="ot">&lt;-</span> <span class="fu">stat</span>(x[<span class="sc">-</span>i, ], J)</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>  L <span class="ot">&lt;-</span> <span class="fu">mean</span>(th.jack) <span class="sc">-</span> th.jack</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>(<span class="dv">6</span> <span class="sc">*</span> <span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># BCa conf. limits</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>  adj.alpha <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(z0 <span class="sc">+</span> (z0<span class="sc">+</span>zalpha)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>a<span class="sc">*</span>(z0<span class="sc">+</span>zalpha)))</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>  limits <span class="ot">&lt;-</span> <span class="fu">quantile</span>(th, adj.alpha, <span class="at">type=</span><span class="dv">6</span>)</span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">&quot;est&quot;</span><span class="ot">=</span>th0, <span class="st">&quot;BCa&quot;</span><span class="ot">=</span>limits))</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.BCa</span>(x, <span class="at">th0 =</span> theta.hat, <span class="at">th =</span> R, <span class="at">stat =</span> eigenmax)</span></code></pre></div>
<pre><code>## $est
## [1] 0.619115
## 
## $BCa
## 3.479638% 98.28732% 
## 0.5225264 0.7004591</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>SK<span class="ot">&lt;-</span><span class="cf">function</span>(x,i){</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">skewness</span>(x[i])</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>ci_basic_No<span class="ot">&lt;-</span>ci_percent_No<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  dt<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  de<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>dt,<span class="at">statistic=</span>SK,<span class="at">R=</span>B)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  ci_basic_No[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>  ci_percent_No[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>perc[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>ci_basic_Chi<span class="ot">&lt;-</span>ci_percent_Chi<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>  dt<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>  de<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>dt,<span class="at">statistic=</span>SK,<span class="at">R=</span>B)</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>  ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>  ci_basic_Chi[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>  ci_percent_Chi[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>perc[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>r_No_Basic<span class="ot">&lt;-</span><span class="fu">mean</span>(ci_basic_No[,<span class="dv">1</span>]<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> ci_basic_No[,<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>r_No_percent<span class="ot">&lt;-</span><span class="fu">mean</span>(ci_percent_No[,<span class="dv">1</span>]<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> ci_percent_No[,<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>r_Chi_Basic<span class="ot">&lt;-</span><span class="fu">mean</span>(ci_basic_Chi[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>r_Chi_percent<span class="ot">&lt;-</span><span class="fu">mean</span>(ci_percent_Chi[,<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>Lable1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;r_No_Basic&quot;</span>,<span class="st">&quot;r_No_percent&quot;</span>,<span class="st">&quot;r_Chi_Basic&quot;</span>,<span class="st">&quot;r_Chi_percent&quot;</span>)</span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>res1<span class="ot">&lt;-</span><span class="fu">c</span>(r_No_Basic,r_No_percent,r_Chi_Basic,r_Chi_percent)</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>re1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Lable1,res1)</span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>re1</span></code></pre></div>
<pre><code>##          Lable1 res1
## 1    r_No_Basic 0.84
## 2  r_No_percent 0.91
## 3   r_Chi_Basic 0.93
## 4 r_Chi_percent 0.87</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>r1_NL <span class="ot">&lt;-</span> <span class="fu">mean</span>(ci_basic_No[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>r1_NR <span class="ot">&lt;-</span> <span class="fu">mean</span>(ci_basic_No[,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>r2_NL <span class="ot">&lt;-</span> <span class="fu">mean</span>(ci_percent_No[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>r2_NR <span class="ot">&lt;-</span> <span class="fu">mean</span>(ci_percent_No[,<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>r1_ChiL <span class="ot">&lt;-</span> <span class="fu">mean</span>(ci_basic_Chi[,<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>r2_ChiL <span class="ot">&lt;-</span> <span class="fu">mean</span>(ci_percent_Chi[,<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>Lable2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;NoSK_Left_Basic&quot;</span>, <span class="st">&quot;NoSK_Right_Basic&quot;</span>, <span class="st">&quot;NoSK_Left_percent&quot;</span>, <span class="st">&quot;NoSK_Right_percent&quot;</span>, <span class="st">&quot;ChiSK_Left_Basic&quot;</span>, <span class="st">&quot;ChiSK_Left_percent&quot;</span>)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">c</span>(r1_NL, r1_NR, r2_NL, r2_NR, r1_ChiL, r2_ChiL)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>re2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Lable2, res2)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>re2</span></code></pre></div>
<pre><code>##               Lable2 res2
## 1    NoSK_Left_Basic 0.08
## 2   NoSK_Right_Basic 0.08
## 3  NoSK_Left_percent 0.05
## 4 NoSK_Right_percent 0.04
## 5   ChiSK_Left_Basic 0.07
## 6 ChiSK_Left_percent 0.13</code></pre>
</div>
<div id="th-3" class="section level2">
<h2>7th</h2>
<ol style="list-style-type: decimal">
<li>8.2: Implement the bivariate Spearman rank correlation test for independence as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method “spearman”. Compare the achieved significance level of the permutation test with the p-value got by cor.test on the same samples.</li>
</ol>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> dt[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> dt[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>cor_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>cor0 <span class="ot">&lt;-</span> cor_res<span class="sc">$</span>statistic</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co">#pooled sample</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="co">#generate indices k for the first sample</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x1, y1, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>statistic</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(cor0, reps) <span class="sc">&gt;=</span> cor0)</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>cor_res</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 146592, p-value = 0.2325
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##     rho 
## 0.12036</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>p_hat</span></code></pre></div>
<pre><code>## [1] 0.888</code></pre>
<p>If p_hat is less than 0.5, two times of p_hat(ASL) is closed to the p-value reported by cor.test; if p_hat is larger than 0.5, two times of 1-p_hat(ASL) is closed to the p-value reported by cor.test.</p>
<ol start="2" style="list-style-type: decimal">
<li>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</li>
</ol>
<p>Unequal variances and equal expectations; Unequal variances and unequal expectations; Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions); Unbalanced samples (say, 1 case versus 10 controls). Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co">#unequal var &amp; equal E</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN) <span class="co"># implementing a fast algorithm</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for locating nearest neighbors</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (alternative R package: &quot;yaImpute&quot;)</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ]</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>  block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>  block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">length</span>(x), <span class="fu">length</span>(y))</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>NN <span class="ot">&lt;-</span> <span class="cf">function</span>(z, N, k){</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> z, <span class="at">statistic =</span> Tn, <span class="at">R =</span> <span class="dv">99</span>,</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> N,<span class="at">k=</span>k)</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>  p</span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="fu">NN</span>(z, N, <span class="dv">3</span>)</span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>p.value</span></code></pre></div>
<pre><code>## [1] 0.04</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>boot.obs <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z, <span class="at">sizes=</span>N, <span class="at">R=</span><span class="dv">99</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>p.value1 <span class="ot">&lt;-</span> boot.obs<span class="sc">$</span>p.value</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>p.value1</span></code></pre></div>
<pre><code>## [1] 0.02</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>p.value2 <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">num.permutations=</span><span class="dv">99</span>)<span class="sc">$</span>p.value</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>p.value2</span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##               0.02</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NN</span>(z, N, <span class="dv">3</span>)</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">99</span>)<span class="sc">$</span>p.value</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.50 0.78 0.88</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#unequal var &amp; unequal E</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">length</span>(x), <span class="fu">length</span>(y))</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="fu">NN</span>(z, N, <span class="dv">3</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>p.value</span></code></pre></div>
<pre><code>## [1] 0.04</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>boot.obs <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z, <span class="at">sizes=</span>N, <span class="at">R=</span><span class="dv">99</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>p.value1 <span class="ot">&lt;-</span> boot.obs<span class="sc">$</span>p.value</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>p.value1</span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>p.value2 <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">num.permutations=</span><span class="dv">99</span>)<span class="sc">$</span>p.value</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>p.value2</span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##               0.01</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NN</span>(z, N, <span class="dv">3</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span><span class="dv">99</span>)<span class="sc">$</span>p.value</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">99</span>)<span class="sc">$</span>p.value</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.70 0.99 0.97</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Non-normal distributions</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">50</span>, <span class="dv">1</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fl">0.3</span><span class="sc">*</span><span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.7</span><span class="sc">*</span><span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">length</span>(x), <span class="fu">length</span>(y))</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="fu">NN</span>(z, N, <span class="dv">3</span>)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>p.value</span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>boot.obs <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z, <span class="at">sizes=</span>N, <span class="at">R=</span><span class="dv">99</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>p.value1 <span class="ot">&lt;-</span> boot.obs<span class="sc">$</span>p.value</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>p.value1</span></code></pre></div>
<pre><code>## [1] 0.01</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>p.value2 <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">num.permutations=</span><span class="dv">99</span>)<span class="sc">$</span>p.value</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>p.value2</span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##               0.01</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">50</span>, <span class="dv">1</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fl">0.3</span><span class="sc">*</span><span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.7</span><span class="sc">*</span><span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NN</span>(z, N, <span class="dv">3</span>)</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">99</span>)<span class="sc">$</span>p.value</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.23 0.45 0.40</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Unbalanced samples</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">length</span>(x), <span class="fu">length</span>(y))</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>p.value <span class="ot">&lt;-</span> <span class="fu">NN</span>(z, N, <span class="dv">3</span>)</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>p.value</span></code></pre></div>
<pre><code>## [1] 0.62</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>boot.obs <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z, <span class="at">sizes=</span>N, <span class="at">R=</span><span class="dv">99</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>p.value1 <span class="ot">&lt;-</span> boot.obs<span class="sc">$</span>p.value</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>p.value1</span></code></pre></div>
<pre><code>## [1] 0.02</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>p.value2 <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">num.permutations=</span><span class="dv">99</span>)<span class="sc">$</span>p.value</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>p.value2</span></code></pre></div>
<pre><code>## bd.constant.pvalue 
##               0.24</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NN</span>(z, N, <span class="dv">3</span>)</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>  p.values[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span><span class="dv">99</span>)<span class="sc">$</span>p.value</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p.values<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>pow</span></code></pre></div>
<pre><code>## [1] 0.42 0.98 0.85</code></pre>
<p>Conclusion: 1. Ball method is the most powerful test when variance is different or both variance and expectation are different. 2. From these four situations, we could see that energy and ball methods are both more powerful than NN method. But the former two methods cannot be uniformly distinguished. Moreover, if these two methods need to be distinguished, we should discuss in different situations.</p>
</div>
<div id="th-4" class="section level2">
<h2>8th</h2>
<p>Answer 9.3</p>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution.</p>
<p><span class="math inline">\(Cauchy(\theta=1,\eta=0)\)</span> distribution: <span class="math display">\[f(x)=\frac{1}{\pi(1+x^2)}.\]</span></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # data generation</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co"># m &lt;- 10000</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- numeric(m)</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="co"># x[1] &lt;- rnorm(1,10)</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># k &lt;- 0</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="co"># u &lt;- runif(m)</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 2:m) {</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   xt &lt;- x[i-1]</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   y &lt;- rnorm(1,xt)</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   num &lt;- dcauchy(y) * dnorm(xt, y)</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   den &lt;- dcauchy(xt) * dnorm(y, xt)</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (u[i] &lt;= num/den) </span></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     x[i] &lt;- y </span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   else {</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     x[i] &lt;- xt</span></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     k &lt;- k+1 #y is rejected</span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="co"># print(k)/m</span></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a><span class="co"># index &lt;- 1000:5000</span></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="co"># y1 &lt;- x[index]</span></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(index, y1, type=&quot;l&quot;, main=&quot;&quot;, ylab=&quot;x&quot;)</span></span></code></pre></div>
<p>Cdf of Cauchy distribution is: <span class="math display">\[F(x)=\frac{1}{\pi}{\rm arctan}x+\frac{1}{2}\]</span></p>
<p>So an explicit formula for the quantiles of Cauchy distribution are given by <span class="math display">\[x_q=F^{-1}(q)={\rm tan}[(q-\frac{1}{2})\pi]\]</span></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b &lt;- 1000 #discard the burning sample</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="co"># y &lt;- x[b:m]</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a &lt;- seq(0.1, 0.9, 0.1)</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co"># QR &lt;- tan((a-0.5)*pi) #deciles of Cauchy</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Q &lt;- quantile(x, a)</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot(QR, Q, main=&quot;&quot;, xlab=&quot;Cauchy deciles&quot;, ylab=&quot;Sample deciles&quot;)</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="co"># y &lt;- x &lt;- seq(-4, 3, 0.01)</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lines(x,y)</span></span></code></pre></div>
<p>From the plot, it appears that the sample deciles are in approximate agreement with the theoretical deciles (the points fall around the line y=x).</p>
<p>Answer 9.8</p>
<p>Fixed a=10, b=10, n=20, the conditional distribution are <span class="math inline">\({\rm Binomial}(20,y)\)</span> and <span class="math inline">\({\rm Beta}(x+10,30-x).\)</span></p>
<p><span class="math display">\[P(X=x|Y=y)=C_{20}^xy^x(1-y)^{20-x}\]</span> <span class="math display">\[f(y|x)=\frac{\Gamma (40)}{\Gamma (x+10)\Gamma (30-x)}y^{x+9}(1-y)^{29-x}\]</span></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>gib.chain <span class="ot">&lt;-</span><span class="cf">function</span>(N,a1,a2){</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(a1,a2)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">20</span>, X[i<span class="dv">-1</span>,<span class="dv">2</span>])</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, X[i,<span class="dv">1</span>]<span class="sc">+</span><span class="dv">10</span>, <span class="dv">30</span><span class="sc">-</span>X[i,<span class="dv">1</span>])</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="co"># N &lt;- 5000</span></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a><span class="co"># b &lt;- 1000</span></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="co"># gib.chain(N, 0, 0)[(b+1):N,]</span></span></code></pre></div>
<p>Answer added question</p>
<p>Use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="co">#9.3 Gelman.Rubin</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>cauchy.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(N, x0) {</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,xt,<span class="dv">1</span>)<span class="co">#candidate point</span></span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>    r1 <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, y, <span class="dv">1</span>)</span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>    r2 <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, xt, <span class="dv">1</span>)</span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> r1 <span class="sc">/</span> r2</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) </span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y </span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a><span class="co"># k &lt;- 4 #number of chains to generate</span></span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a><span class="co"># n &lt;- 15000 #length of chains</span></span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a><span class="co"># b &lt;- 1000 #burn-in length</span></span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a><span class="co"># #choose overdispersed initial values</span></span>
<span id="cb140-35"><a href="#cb140-35" aria-hidden="true" tabindex="-1"></a><span class="co"># x0 &lt;- c(-10, -5, 5, 10)</span></span>
<span id="cb140-36"><a href="#cb140-36" aria-hidden="true" tabindex="-1"></a><span class="co"># #generate the chains</span></span>
<span id="cb140-37"><a href="#cb140-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Y &lt;- matrix(0, nrow=k, ncol=n)</span></span>
<span id="cb140-38"><a href="#cb140-38" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:k)</span></span>
<span id="cb140-39"><a href="#cb140-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   Y[i, ] &lt;- cauchy.chain(n, x0[i])</span></span>
<span id="cb140-40"><a href="#cb140-40" aria-hidden="true" tabindex="-1"></a><span class="co"># #compute diagnostic statistics</span></span>
<span id="cb140-41"><a href="#cb140-41" aria-hidden="true" tabindex="-1"></a><span class="co"># psi &lt;- t(apply(Y, 1, cumsum))</span></span>
<span id="cb140-42"><a href="#cb140-42" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:nrow(psi))</span></span>
<span id="cb140-43"><a href="#cb140-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   psi[i,] &lt;- psi[i,] / (1:ncol(psi))</span></span>
<span id="cb140-44"><a href="#cb140-44" aria-hidden="true" tabindex="-1"></a><span class="co"># print(Gelman.Rubin(psi))</span></span>
<span id="cb140-45"><a href="#cb140-45" aria-hidden="true" tabindex="-1"></a><span class="co"># #plot psi for the four chains</span></span>
<span id="cb140-46"><a href="#cb140-46" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(psi[1, (b+1):n], type=&quot;l&quot;)</span></span>
<span id="cb140-47"><a href="#cb140-47" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(psi[2, (b+1):n], type=&quot;l&quot;)</span></span>
<span id="cb140-48"><a href="#cb140-48" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(psi[3, (b+1):n], type=&quot;l&quot;)</span></span>
<span id="cb140-49"><a href="#cb140-49" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(psi[4, (b+1):n], type=&quot;l&quot;)</span></span>
<span id="cb140-50"><a href="#cb140-50" aria-hidden="true" tabindex="-1"></a><span class="co"># rhat &lt;- rep(0, n)</span></span>
<span id="cb140-51"><a href="#cb140-51" aria-hidden="true" tabindex="-1"></a><span class="co"># for (j in (b+1):n)</span></span>
<span id="cb140-52"><a href="#cb140-52" aria-hidden="true" tabindex="-1"></a><span class="co">#   rhat[j] &lt;- Gelman.Rubin(psi[,1:j])</span></span>
<span id="cb140-53"><a href="#cb140-53" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rhat[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;)</span></span>
<span id="cb140-54"><a href="#cb140-54" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb140-55"><a href="#cb140-55" aria-hidden="true" tabindex="-1"></a><span class="co"># #9.8 Gelman.Rubin</span></span>
<span id="cb140-56"><a href="#cb140-56" aria-hidden="true" tabindex="-1"></a><span class="co"># k &lt;- 4</span></span>
<span id="cb140-57"><a href="#cb140-57" aria-hidden="true" tabindex="-1"></a><span class="co"># n &lt;- 15000</span></span>
<span id="cb140-58"><a href="#cb140-58" aria-hidden="true" tabindex="-1"></a><span class="co"># b &lt;- 1000</span></span>
<span id="cb140-59"><a href="#cb140-59" aria-hidden="true" tabindex="-1"></a><span class="co"># #generate the chains</span></span>
<span id="cb140-60"><a href="#cb140-60" aria-hidden="true" tabindex="-1"></a><span class="co"># X1 &lt;- X2 &lt;- matrix(0, nrow=k, ncol=n)</span></span>
<span id="cb140-61"><a href="#cb140-61" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:k){</span></span>
<span id="cb140-62"><a href="#cb140-62" aria-hidden="true" tabindex="-1"></a><span class="co">#   X1[i, ] &lt;- gib.chain(n, 0, 0)[,1]</span></span>
<span id="cb140-63"><a href="#cb140-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   X2[i, ] &lt;- gib.chain(n, 0, 0)[,2]</span></span>
<span id="cb140-64"><a href="#cb140-64" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb140-65"><a href="#cb140-65" aria-hidden="true" tabindex="-1"></a><span class="co"># #compute diagnostic statistics</span></span>
<span id="cb140-66"><a href="#cb140-66" aria-hidden="true" tabindex="-1"></a><span class="co"># psi1 &lt;- t(apply(X1, 1, cumsum))</span></span>
<span id="cb140-67"><a href="#cb140-67" aria-hidden="true" tabindex="-1"></a><span class="co"># psi2 &lt;- t(apply(X2, 1, cumsum))</span></span>
<span id="cb140-68"><a href="#cb140-68" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:nrow(psi)){</span></span>
<span id="cb140-69"><a href="#cb140-69" aria-hidden="true" tabindex="-1"></a><span class="co">#   psi1[i,] &lt;- psi1[i,] / (1:ncol(psi1))</span></span>
<span id="cb140-70"><a href="#cb140-70" aria-hidden="true" tabindex="-1"></a><span class="co">#   psi2[i,] &lt;- psi2[i,] / (1:ncol(psi2))</span></span>
<span id="cb140-71"><a href="#cb140-71" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb140-72"><a href="#cb140-72" aria-hidden="true" tabindex="-1"></a><span class="co"># print(Gelman.Rubin(psi1))</span></span>
<span id="cb140-73"><a href="#cb140-73" aria-hidden="true" tabindex="-1"></a><span class="co"># print(Gelman.Rubin(psi2))</span></span>
<span id="cb140-74"><a href="#cb140-74" aria-hidden="true" tabindex="-1"></a><span class="co"># #plot psi for the four chains</span></span>
<span id="cb140-75"><a href="#cb140-75" aria-hidden="true" tabindex="-1"></a><span class="co"># rhat1 &lt;- rhat2 &lt;- rep(0, n)</span></span>
<span id="cb140-76"><a href="#cb140-76" aria-hidden="true" tabindex="-1"></a><span class="co"># for (j in (b+1):n){</span></span>
<span id="cb140-77"><a href="#cb140-77" aria-hidden="true" tabindex="-1"></a><span class="co">#   rhat1[j] &lt;- Gelman.Rubin(psi1[,1:j])</span></span>
<span id="cb140-78"><a href="#cb140-78" aria-hidden="true" tabindex="-1"></a><span class="co">#   rhat2[j] &lt;- Gelman.Rubin(psi2[,1:j])</span></span>
<span id="cb140-79"><a href="#cb140-79" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb140-80"><a href="#cb140-80" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rhat1[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;, main=&quot;x&quot;)</span></span>
<span id="cb140-81"><a href="#cb140-81" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(rhat2[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;, main=&quot;y&quot;)</span></span></code></pre></div>
<p>In both exercises, all chains meet the requirements for convergences: <span class="math inline">\(\hat R&lt;1.2\)</span>.</p>
</div>
<div id="th-5" class="section level2">
<h2>9th</h2>
<p>11.3 To compute the <span class="math inline">\(k^{{\rm th}}\)</span> term in the summation formula and return the sum.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>f_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(k,a,d){</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="fu">prod</span>(<span class="dv">1</span><span class="sc">:</span>k)<span class="sc">*</span><span class="fu">norm</span>(a,<span class="st">&quot;2&quot;</span>)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">gamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>f1_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a,d){</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">f_1</span>(k,a,d)</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">abs</span>(y) <span class="sc">&gt;</span> <span class="fl">1e-5</span>){<span class="co"># condition for convergence (error)</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>    sum <span class="ot">&lt;-</span> sum<span class="sc">+</span>y</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">f_1</span>(k,a,d)</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(sum,k))</span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>k_a <span class="ot">&lt;-</span> <span class="fu">f_1</span>(<span class="dv">10</span>,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">2</span>)<span class="co"># the kth of this sum</span></span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>k_a</span></code></pre></div>
<pre><code>## [1] 7.514156e-06</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>sum_a <span class="ot">&lt;-</span> <span class="fu">f1_sum</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">2</span>)<span class="co"># print out the sum and k when it converges(error&lt;1e-5).</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>sum_a</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.4313378
## 
## [[2]]
## [1] 10</code></pre>
<p>11.5</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 11.4/11.5</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="co"># s_k(a)</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>sk1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>))</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">1</span>),<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> res2 <span class="ot">&lt;-</span> <span class="fu">length</span>(k)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)) {</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">sqrt</span>(k[i]),<span class="fl">0.005</span>)</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(a))</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a)) {</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>    p1[j]<span class="ot">&lt;-</span><span class="fu">sk1</span>(a[j],k[i])</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>    p2[j]<span class="ot">&lt;-</span><span class="fu">sk1</span>(a[j],k[i]<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the best choice for approximate equality and get its index</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>  index_min <span class="ot">&lt;-</span> <span class="fu">which.min</span>(<span class="fu">abs</span>(p2[<span class="sc">-</span><span class="dv">1</span>]<span class="sc">-</span>p1[<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>  res1[i] <span class="ot">&lt;-</span> a[<span class="sc">-</span><span class="dv">1</span>][index_min]</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a><span class="co"># two sides of the equation in 11.5 are pdf of t distribution with (k-1) and k degrees of freedom</span></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)) {</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>  sk2 <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>    int1 <span class="ot">&lt;-</span> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k[i]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span>(k[i]<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k[i]<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a>    int2 <span class="ot">&lt;-</span> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k[i])<span class="sc">/</span>(k[i]<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),k[i])</span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(int1<span class="sc">-</span>int2)</span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a>  res2[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(sk2,<span class="fu">c</span>(<span class="fl">0.0001</span>,<span class="fu">sqrt</span>(k[i])<span class="sc">-</span><span class="fl">0.0001</span>))<span class="sc">$</span>root</span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a>res1</span></code></pre></div>
<pre><code>##  [1] 1.490 1.535 1.565 1.585 1.600 1.615 1.625 3.315 3.460 3.605 3.740 3.870
## [13] 4.000 4.120 4.240 4.355 4.470 4.580 4.690 4.780 4.860 4.940 6.890 7.270
## [25] 7.160</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>res2</span></code></pre></div>
<pre><code>##  [1]  1.492103  1.533549  1.562768  1.584421  1.601192  1.614517  1.625391
##  [8]  1.634409  1.642004  1.648565  1.654167  1.659099  1.663452  1.667288
## [15]  1.670736  1.673840  1.676588  1.679139  1.681461  4.795732  4.898879
## [22]  4.999900  9.999900 22.360580 31.622677</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">abs</span>(res1<span class="sc">-</span>res2)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(res1,res2,error))</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>##     res1      res2        error
## 1  1.490  1.492103 2.102871e-03
## 2  1.535  1.533549 1.451348e-03
## 3  1.565  1.562768 2.232065e-03
## 4  1.585  1.584421 5.790762e-04
## 5  1.600  1.601192 1.191777e-03
## 6  1.615  1.614517 4.825992e-04
## 7  1.625  1.625391 3.910203e-04
## 8  3.315  1.634409 1.680591e+00
## 9  3.460  1.642004 1.817996e+00
## 10 3.605  1.648565 1.956435e+00
## 11 3.740  1.654167 2.085833e+00
## 12 3.870  1.659099 2.210901e+00
## 13 4.000  1.663452 2.336548e+00
## 14 4.120  1.667288 2.452712e+00
## 15 4.240  1.670736 2.569264e+00
## 16 4.355  1.673840 2.681160e+00
## 17 4.470  1.676588 2.793412e+00
## 18 4.580  1.679139 2.900861e+00
## 19 4.690  1.681461 3.008539e+00
## 20 4.780  4.795732 1.573152e-02
## 21 4.860  4.898879 3.887949e-02
## 22 4.940  4.999900 5.990000e-02
## 23 6.890  9.999900 3.109900e+00
## 24 7.270 22.360580 1.509058e+01
## 25 7.160 31.622677 2.446268e+01</code></pre>
<p>Conclusion: 1. When <span class="math inline">\(k\leq 25\)</span>, the distance between 11.4 and 11.5 is not significant; 2. The results in 11.4 and 11.5 differ much more from each other when <span class="math inline">\(k\)</span> increases(<span class="math inline">\(k\geq 100\)</span>).</p>
</div>
<div id="answer-added-exercise-em-algorithm" class="section level2">
<h2>Answer added exercise – EM algorithm</h2>
<p>The number of samples meeting <span class="math inline">\(T_i&gt;1\)</span> is 3, and the number of samples meeting <span class="math inline">\(T_i\leq1\)</span> is 7. So we let the complete <a href="data:$(y_1" class="uri">data:$(y_1</a>,…,y_7,z_1,z_2,z_3),y=(y_1,…,y_7),z=(z_1,z_2,z_3)$, <span class="math inline">\(z\)</span> is unknown.</p>
<p><span class="math display">\[L_c(\lambda)=\lambda^{10}\exp\{-\lambda(\sum_{i=1}^7y_i+\sum_{j=1}^3z_j)\}\]</span> E step: <span class="math display">\[\mathbb{E}[z_j|\hat{\lambda^{(i)}}]=\mathbb{E}[z_j]/\mathbb{P}(\hat{\lambda^{(i)}})=\int_1^\infty\lambda z_i(\exp(-\lambda z_i))\mathrm{d}z_i/\exp(-\lambda )=1+\frac{1}{\hat{\lambda}^{(i)}}\]</span> <span class="math display">\[\mathbb{E}[l_c(\lambda)]=10\ln\lambda - \lambda(\sum_{i=1}^7y_i+\sum_{j=1}^3\mathbb{E}[z_j|\hat{\lambda^{(i)}}])\]</span> <span class="math display">\[\frac{\mathrm{d}\mathbb{E}[l_c(\lambda)]}{\mathrm{d\lambda}}=\left[\frac{10}{\lambda}-(\sum_{i=1}^7y_i+\sum_{j=1}^3\mathbb{E}[z_j|\hat{\lambda^{(i)}}])\right]=0\]</span> So we can get: <span class="math display">\[\hat{\lambda}^{(i+1)}=\frac{10}{\sum_{i=1}^7y_i+\sum_{j=1}^3\mathbb{E}z_j}=\frac{10}{\sum_{i=1}^7y_i+3(1+\frac{1}{\hat{\lambda}^{(i)}})}.\]</span> The likelihood function of observed data is <span class="math display">\[L_o(\lambda)=\lambda^7\exp\{-\lambda\sum_{i=1}^7y_i\}\Pi_{i=1}^{3}\exp(-\lambda)\]</span> <span class="math display">\[l_0(\lambda)=7\ln\lambda -\lambda\sum_{i=1}^7y_i-3\lambda.\]</span> So we can get:<span class="math display">\[\lambda=\frac{7}{\sum_{i=1}^7y_i+3}.\]</span></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>lambda[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.91</span>,<span class="dv">1</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  lambda[i] <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">/</span>(<span class="fu">sum</span>(y)<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span>lambda[i<span class="dv">-1</span>])</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>lambda_0 <span class="ot">&lt;-</span> <span class="dv">7</span><span class="sc">/</span><span class="fu">sum</span>(y)</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>lambda[m]</span></code></pre></div>
<pre><code>## [1] 1.037037</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>lambda_0</span></code></pre></div>
<pre><code>## [1] 1.037037</code></pre>
<p>So we can easily get the conclusion that value of <span class="math inline">\(\lambda\)</span> got from EM algorithm converges to the true <span class="math inline">\(\lambda\)</span>.</p>
</div>
<div id="th-6" class="section level2">
<h2>10th</h2>
<p>1.1</p>
<p>Discuss the reason why these two invocations of lapply() equivalent.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.339133
## 
## [[2]]
## [1] -0.1483246
## 
## [[3]]
## [1] -0.1110891
## 
## [[4]]
## [1] -0.004011465</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] -0.339133
## 
## [[2]]
## [1] -0.1483246
## 
## [[3]]
## [1] -0.1110891
## 
## [[4]]
## [1] -0.004011465</code></pre>
<p>Why are the following two invocations of lapply() equivalent?</p>
<ol style="list-style-type: decimal">
<li><p>We can use an anonymous function or a new named function or a built-in function.</p></li>
<li><p>lapply() can take a name of an function searched from match.fun, so <code>mean</code> function works(the second line). Then lapply() can apply <code>mean</code> to <code>trims</code>.</p></li>
<li><p>For the second line, by <code>x = x</code>, lapply() knows that the x is the variable for <code>mean</code> function, and then passes <code>trims</code> as the second argument to <code>mean</code>.</p></li>
</ol>
<p>1.5</p>
<p>For each model in 1.3 and 1.4, extract <span class="math inline">\(R^2\)</span> using:</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.3</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="co"># With a for loop</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>out_1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(formulas))</span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (formula <span class="cf">in</span> formulas) { </span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>  out_1[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> mtcars)</span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span> </span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="co"># With lapply</span></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>out_2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm, <span class="at">data =</span> mtcars)</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.4</span></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a><span class="co"># With a for loop</span></span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a>out_3 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(bootstraps))  </span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (bootstrap <span class="cf">in</span> bootstraps) {</span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a>  out_3[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstrap)</span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a><span class="co"># With lapply</span></span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a>out_4 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.5</span></span>
<span id="cb159-34"><a href="#cb159-34" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb159-35"><a href="#cb159-35" aria-hidden="true" tabindex="-1"></a>outs <span class="ot">&lt;-</span> <span class="fu">list</span>(out_1, out_2, out_3, out_4)</span>
<span id="cb159-36"><a href="#cb159-36" aria-hidden="true" tabindex="-1"></a>rsqs <span class="ot">&lt;-</span> <span class="cf">function</span>(out) <span class="fu">lapply</span>(out, rsq)</span>
<span id="cb159-37"><a href="#cb159-37" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(outs, rsqs)</span></code></pre></div>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] 0.7183433
## 
## [[1]][[2]]
## [1] 0.8596865
## 
## [[1]][[3]]
## [1] 0.7809306
## 
## [[1]][[4]]
## [1] 0.8838038
## 
## 
## [[2]]
## [[2]][[1]]
## [1] 0.7183433
## 
## [[2]][[2]]
## [1] 0.8596865
## 
## [[2]][[3]]
## [1] 0.7809306
## 
## [[2]][[4]]
## [1] 0.8838038
## 
## 
## [[3]]
## [[3]][[1]]
## [1] 0.6836611
## 
## [[3]][[2]]
## [1] 0.6911067
## 
## [[3]][[3]]
## [1] 0.7128711
## 
## [[3]][[4]]
## [1] 0.7432068
## 
## [[3]][[5]]
## [1] 0.6840578
## 
## [[3]][[6]]
## [1] 0.7421924
## 
## [[3]][[7]]
## [1] 0.8101539
## 
## [[3]][[8]]
## [1] 0.7683749
## 
## [[3]][[9]]
## [1] 0.8051267
## 
## [[3]][[10]]
## [1] 0.7192736
## 
## 
## [[4]]
## [[4]][[1]]
## [1] 0.6836611
## 
## [[4]][[2]]
## [1] 0.6911067
## 
## [[4]][[3]]
## [1] 0.7128711
## 
## [[4]][[4]]
## [1] 0.7432068
## 
## [[4]][[5]]
## [1] 0.6840578
## 
## [[4]][[6]]
## [1] 0.7421924
## 
## [[4]][[7]]
## [1] 0.8101539
## 
## [[4]][[8]]
## [1] 0.7683749
## 
## [[4]][[9]]
## [1] 0.8051267
## 
## [[4]][[10]]
## [1] 0.7192736</code></pre>
<p>2.1</p>
<p>Use vapply() to compute the standard deviation of every column in a numeric data frame and to compute the standard deviation of every numeric column in a mixed data frame.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mtcars, sd, <span class="fu">numeric</span>(<span class="dv">1</span>)) <span class="co"># numeric data frame</span></span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>sd0 <span class="ot">&lt;-</span> <span class="cf">function</span>(data) <span class="fu">vapply</span>(data[<span class="fu">vapply</span>(data, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))], sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd0</span>(USJudgeRatings) <span class="co"># mixed data frame</span></span></code></pre></div>
<pre><code>##      CONT      INTG      DMNR      DILG      CFMG      DECI      PREP      FAMI 
## 0.9408768 0.7701447 1.1437054 0.9008978 0.8601102 0.8029362 0.9533702 0.9489868 
##      ORAL      WRIT      PHYS      RTEN 
## 1.0100437 0.9611328 0.9395753 1.1009711</code></pre>
<p>2.7</p>
<p>Implement mcsapply(), a multicore version of sapply(). Can mcvapply() be implemented?</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mcapply()</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>mcsapply<span class="ot">&lt;-</span><span class="cf">function</span>(x,fun){</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>  cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">3</span>)</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">parSapply</span>(cl, x, fun)</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopCluster</span>(cl)</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(f)</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>simulation <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">500</span>,</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="fu">rcauchy</span>(<span class="dv">10</span>, <span class="dv">5</span>)), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="fu">system.time</span>(<span class="fu">mcsapply</span>(simulation, <span class="cf">function</span>(x) {</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>(x)[<span class="dv">3</span>]</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>})),<span class="fu">system.time</span>(<span class="fu">sapply</span>(simulation, <span class="cf">function</span>(x) {</span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>(x)[<span class="dv">3</span>]</span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>})))</span></code></pre></div>
<pre><code>## [[1]]
## 用户 系统 流逝 
## 0.02 0.06 0.48 
## 
## [[2]]
## 用户 系统 流逝 
## 0.03 0.00 0.03</code></pre>
<p>We can see computing speed gets great increased, so I think the mcvapply() can be implemented as mcsapply() does.</p>
</div>
<div id="th-7" class="section level2">
<h2>11th</h2>
<p>Answer 1</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R code</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>gib.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n){</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, X[i<span class="dv">-1</span>, <span class="dv">2</span>])</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, X[i, <span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">+</span> b <span class="sc">-</span> X[i, <span class="dv">1</span>])</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N, ]</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(x)</span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a><span class="co"># C++ code (Rcpp function)</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix gib_chain_rcpp(double a, double b, double m) {</span></span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a><span class="st">  int N = 5000;</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a><span class="st">  int burn = 1000;</span></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix X(N, 2);</span></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericVector v = {0, 0};</span></span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a><span class="st">  X(0, _) = v;</span></span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a><span class="st">  for (int i = 1; i &lt; N; i++) {</span></span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a><span class="st">    double x1 = X(i - 1, 1);</span></span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a><span class="st">    X(i, 0) = as&lt;int&gt;(rbinom(1, m, x1));</span></span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a><span class="st">    int x0 = X(i, 0);</span></span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a><span class="st">    X(i, 1) = as&lt;double&gt;(rbeta(1, x0 + a, m + b - x0));</span></span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix x = X(Range(burn - 1, N - 1), Range(0, 1));</span></span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a><span class="st">  return x;</span></span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<p>Answer 2</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>X_R <span class="ot">&lt;-</span> <span class="fu">gib.chain</span>(a, b, n)</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>X_C <span class="ot">&lt;-</span> <span class="fu">gib_chain_rcpp</span>(a, b, n)</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X_R[, <span class="dv">1</span>], X_C[, <span class="dv">1</span>], <span class="at">xlab =</span> <span class="st">&quot;Discrete_R&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Discrete_Rcpp&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X_R[, <span class="dv">2</span>], X_C[, <span class="dv">2</span>], <span class="at">xlab =</span> <span class="st">&quot;Continuous_R&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Continuous_Rcpp&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Answer 3</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(ts1 <span class="ot">&lt;-</span> <span class="fu">gib.chain</span>(a, b, n), ts2 <span class="ot">&lt;-</span> <span class="fu">gib_chain_rcpp</span>(a, b, n))</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>ts</span></code></pre></div>
<pre><code>## Unit: milliseconds
##                            expr       min      lq      mean    median        uq
##       ts1 &lt;- gib.chain(a, b, n) 27.436001 37.7302 52.381346 47.121550 61.778201
##  ts2 &lt;- gib_chain_rcpp(a, b, n)  2.773601  3.1200  4.411182  3.957951  5.298951
##         max neval cld
##  240.578801   100   b
##    9.796501   100  a</code></pre>
<p>Answer 4 Comments for result: Rcpp function can perform as R function does, but Rcpp function can be more efficient.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
